<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>请求端</title>
</head>
<style>
    #view{
        width:100vw;
        height: calc(100vh - 50px);
    }
    #live{
        width:30vw;
        height: calc(100vh - 50px);
    }
    #share{
        width:68vw;
        height: calc(100vh - 50px);
    }
    #tool{
        height: 50px;
    }
</style>
<body>
    <div id="view">
        <video id="myView" style="transform: scale(-1, 1);"></video>
        <video id="objView" style="transform: scale(-1, 1);"></video>

    </div>
    <ul id='userList'>

    </ul>
    <div id="tool">
        <button onclick="closeWin('zmyMain')">closeWin</button>
        <button onclick="videoChatOn()">视频</button>
        <button onclick="desktopShareOn('zmy')">分享桌面画面</button>
        <button onclick="p2p()">link</button>
    </div>
</body>
<script src="./renderer.js"></script>
<script>
    window.onload=()=>{
        let users=getUsers();

        users.then(res=>{
            res.forEach(user => {
                let userLi=document.createElement('li');
                userLi.innerHTML=`<div>用户名：${user.username}<button onclick='linkTo("${user.username}")'>🔗连接</button></div>`
                document.getElementById('userList').appendChild(userLi)
            });
        }).catch(err=>{
            console.error(err)
        })
    }

    function linkTo(username){
        let myView=document.getElementById('myView')
        let objView=document.getElementById('objView')
        videoChat(username,myView,objView)
    }


    // function videoChatOn(){
    //     videoChat(document.getElementById('live'));
    // }
    function desktopShareOn(){
        desktopShare(document.getElementById('share'));
    }
</script>
</html>